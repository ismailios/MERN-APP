{"ast":null,"code":"import { BASE_URL } from \"../../config/config\";\nexport const SIGNUP = \"SIGNUP\";\nexport const LOGIN = \"LOGIN\";\nexport const LOGOUT = \"LOGOUT\";\nexport const AUTHENTICATE = \"AUTHENTICATE\";\nconst formData = new FormData();\nlet timer;\nconst expirationDate = new Date(new Date().getTime() + parseInt(36 * 1000));\nexport const authenticate = (userId, token, expiryTime) => {\n  return dispatch => {\n    dispatch(setLogoutTimer(expiryTime));\n    dispatch({\n      type: AUTHENTICATE,\n      userId: userId,\n      token: token,\n      expiryTime: expiryTime\n    });\n  };\n};\nexport const signUp = (username, email, password) => {\n  return async dispatch => {\n    formData.append(\"username\", username);\n    formData.append(\"email\", email);\n    formData.append(\"password\", password);\n    const response = await fetch(BASE_URL + \"signup\", {\n      method: \"POST\",\n      body: formData\n    });\n\n    if (!response.ok) {\n      throw new Error(\"Something went Wrong !!\");\n    }\n\n    const resData = await response.json();\n    dispatch({\n      type: SIGNUP\n    });\n  };\n};\nexport const login = (email, password) => {\n  return async dispatch => {\n    formData.append(\"email\", email);\n    formData.append(\"password\", password);\n    const response = await fetch(BASE_URL + \"login\", {\n      method: \"POST\",\n      body: formData\n    });\n\n    if (!response.ok) {\n      throw new Error(\"Something went Wrong !!\");\n    }\n\n    const resData = await response.json();\n    dispatch(authenticate(resData.userId, resData.token, expirationDate));\n    saveDataToStorage(resData.token, resData.userId, expirationDate);\n  };\n};\nexport const logout = () => {\n  clearLogoutTimer();\n  localStorage.removeItem(\"userData\");\n  return {\n    type: LOGOUT\n  };\n};\n\nconst clearLogoutTimer = () => {\n  if (timer) {\n    clearTimeout(timer);\n  }\n};\n\nconst setLogoutTimer = expirationTime => {\n  return dispatch => {\n    timer = setTimeout(() => {\n      dispatch(logout());\n    }, expirationTime);\n  };\n};\n\nconst saveDataToStorage = (token, userId, expirationData) => {\n  localStorage.setItem(\"userData\", JSON.stringify({\n    token: token,\n    userId: userId,\n    expiryDate: expirationData.toISOString()\n  }));\n};","map":{"version":3,"sources":["/Users/user/Desktop/Projects/Node Js/Recap/nodeJS-ReactJS-Crud/frontend/src/store/auth/actions.js"],"names":["BASE_URL","SIGNUP","LOGIN","LOGOUT","AUTHENTICATE","formData","FormData","timer","expirationDate","Date","getTime","parseInt","authenticate","userId","token","expiryTime","dispatch","setLogoutTimer","type","signUp","username","email","password","append","response","fetch","method","body","ok","Error","resData","json","login","saveDataToStorage","logout","clearLogoutTimer","localStorage","removeItem","clearTimeout","expirationTime","setTimeout","expirationData","setItem","JSON","stringify","expiryDate","toISOString"],"mappings":"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","sourcesContent":["import { BASE_URL } from \"../../config/config\";\n\nexport const SIGNUP = \"SIGNUP\";\nexport const LOGIN = \"LOGIN\";\nexport const LOGOUT = \"LOGOUT\";\nexport const AUTHENTICATE = \"AUTHENTICATE\";\n\nconst formData = new FormData();\nlet timer;\nconst expirationDate = new Date(new Date().getTime() + parseInt(36 * 1000));\n\nexport const authenticate = (userId, token, expiryTime) => {\n  return (dispatch) => {\n    dispatch(setLogoutTimer(expiryTime));\n    dispatch({\n      type: AUTHENTICATE,\n      userId: userId,\n      token: token,\n      expiryTime: expiryTime,\n    });\n  };\n};\n\nexport const signUp = (username, email, password) => {\n  return async (dispatch) => {\n    formData.append(\"username\", username);\n    formData.append(\"email\", email);\n    formData.append(\"password\", password);\n    const response = await fetch(BASE_URL + \"signup\", {\n      method: \"POST\",\n      body: formData,\n    });\n\n    if (!response.ok) {\n      throw new Error(\"Something went Wrong !!\");\n    }\n    const resData = await response.json();\n\n    dispatch({\n      type: SIGNUP,\n    });\n  };\n};\n\nexport const login = (email, password) => {\n  return async (dispatch) => {\n    formData.append(\"email\", email);\n    formData.append(\"password\", password);\n\n    const response = await fetch(BASE_URL + \"login\", {\n      method: \"POST\",\n      body: formData,\n    });\n\n    if (!response.ok) {\n      throw new Error(\"Something went Wrong !!\");\n    }\n\n    const resData = await response.json();\n\n    dispatch(authenticate(resData.userId, resData.token, expirationDate));\n\n    saveDataToStorage(resData.token, resData.userId, expirationDate);\n  };\n};\n\nexport const logout = () => {\n  clearLogoutTimer();\n  localStorage.removeItem(\"userData\");\n  return {\n    type: LOGOUT,\n  };\n};\n\nconst clearLogoutTimer = () => {\n  if (timer) {\n    clearTimeout(timer);\n  }\n};\n\nconst setLogoutTimer = (expirationTime) => {\n  return (dispatch) => {\n    timer = setTimeout(() => {\n      dispatch(logout());\n    }, expirationTime);\n  };\n};\n\nconst saveDataToStorage = (token, userId, expirationData) => {\n  localStorage.setItem(\n    \"userData\",\n    JSON.stringify({\n      token: token,\n      userId: userId,\n      expiryDate: expirationData.toISOString(),\n    })\n  );\n};\n"]},"metadata":{},"sourceType":"module"}